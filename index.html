<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Foodie Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // 1. åˆå§‹åŒ–åœ°å›¾ (ä¸­å¿ƒç‚¹æŒ‡å‘ä¸­å›½)
    const map = L.map('map').setView([35.0, 105.0], 5);

    // 2. åŠ è½½æµ…è‰²å¹²å‡€åº•å›¾
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
        attribution: '&copy; OpenStreetMap &copy; CARTO'
    }).addTo(map);

    // 3. å¼‚æ­¥è¯»å–æ•°æ®
    fetch('data.json')
        .then(res => res.json())
        .then(data => {
            data.forEach(item => {
                // å¤„ç†å›¾ç‰‡ HTML
                let imgs = '';
                if (item.images && item.images.length > 0) {
                    imgs = '<div class="image-container">';
                    item.images.forEach(src => {
                        imgs += `<img src="${src}" class="food-pic" onclick="window.open('${src}')">`;
                    });
                    imgs += '</div>';
                }

                // ç»„è£…å†…å®¹
                const content = `
                    <span class="popup-title">${item.name}</span>
                    <span class="tag">${item.type}</span>
                    ${imgs}
                    <div class="note">${item.note}</div>
                    <a href="${item.url}" target="_blank" class="detail-link">ğŸ“ å¯¼èˆª/è¯¦æƒ…</a>
                `;

                // æ‰“ç‚¹
                L.marker(item.coords).addTo(map).bindPopup(content, { maxWidth: 320 });
            });
        })
        .catch(err => console.error("æ•°æ®åŠ è½½å¤±è´¥:", err));
</script>
</body>
</html>
