<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>My Foodie Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <div id="map"></div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const map = L.map('map').setView([35.0, 105.0], 4); // é»˜è®¤æ˜¾ç¤ºä¸­å›½å…¨å›¾

        // ä½¿ç”¨æ›´æ¸…çˆ½çš„åº•å›¾æ ·å¼ (CartoDB Light)
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);

        // å¼‚æ­¥è·å– JSON æ•°æ®
        fetch('data.json')
        .then(response => response.json())
        .then(data => {
            data.forEach(item => {
                // 1. å…ˆå¤„ç†å›¾ç‰‡æ•°ç»„ï¼Œç”Ÿæˆ <img> æ ‡ç­¾åˆ—è¡¨
                let imgHtml = '';
                if (item.images && item.images.length > 0) {
                    imgHtml = '<div class="image-container">';
                    item.images.forEach(imgUrl => {
                        imgHtml += `<img src="${imgUrl}" class="food-pic" onclick="window.open('${imgUrl}')">`;
                    });
                    imgHtml += '</div>';
                }
    
                // 2. ç»„è£…æ•´ä¸ªå¼¹çª—å†…å®¹
                const popupContent = `
                    <span class="popup-title">${item.name}</span>
                    <span class="tag">${item.type}</span>
                    ${imgHtml} 
                    <div class="note">${item.note}</div>
                    <a href="${item.url}" target="_blank" class="detail-link">ğŸ”— æŸ¥çœ‹è¯¦æƒ… / å¯¼èˆª</a>
                `;
    
                L.marker(item.coords).addTo(map).bindPopup(popupContent, {
                    maxWidth: 300 // é™åˆ¶å¼¹çª—æœ€å¤§å®½åº¦ï¼Œé˜²æ­¢å›¾ç‰‡æ’‘çˆ†
                });
            });
        });
    </script>
</body>
</html>
